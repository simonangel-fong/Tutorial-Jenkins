jenkins:
  systemMessage: "Example of Agent"

  securityRealm:
    local:
      allowsSignup: false
      enableCaptcha: false
      users:
      - id: ${JENKINS_ADMIN_ID}
        password: ${JENKINS_ADMIN_PASSWORD}

  nodes:
  - permanent:
      labelString: "ubuntu_agent"
      launcher:
        ssh:
          credentialsId: "jenkins_ssh"
          host: "192.168.100.110"
          port: 22
          sshHostKeyVerificationStrategy:
            manuallyTrustedKeyVerificationStrategy:
              requireInitialManualTrust: false
      name: "ubuntu_agent"
      numExecutors: 2
      remoteFS: "/home/jenkins/agent"
      retentionStrategy: "always"
  numExecutors: 0

credentials:
  system:
    domainCredentials:
    - credentials:
      - basicSSHUserPrivateKey:
          description: "ssh credential with agent"
          id: "jenkins_ssh"
          privateKeySource:
            directEntry:
              privateKey: ${SSH_PRIVATE_KEY}
          scope: GLOBAL
          username: "jenkins"
          usernameSecret: true

tool:
  git:
    installations:
    - home: "git"
      name: "Default"
  mavenGlobalConfig:
    globalSettingsProvider: "standard"
    settingsProvider: "standard"

jobs:
  - script: >
      pipelineJob('test_vm_agent') {
        definition {
          cpsScm {
            scm {
              git {
                remote {
                  url('https://github.com/simonangel-fong/Tutorial-Jenkins.git')
                }
                branch('*/master')
              }
            }
            scriptPath('module_agent/Jenkinsfile')
          }
        }
      }
